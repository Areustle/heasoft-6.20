<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>heasp</TITLE>
<META NAME="description" CONTENT="heasp">
<META NAME="keywords" CONTENT="developers_guide">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="developers_guide.css">

<LINK REL="previous" HREF="node15.html">
<LINK REL="up" HREF="node12.html">
<LINK REL="next" HREF="node17.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html258"
  HREF="node17.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/sw/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html254"
  HREF="node12.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/sw/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html250"
  HREF="node15.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/sw/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html256"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/sw/share/lib/latex2html/icons/contents.png"></A>  
 <A HREF="http://heasarc.gsfc.nasa.gov/docs/software/lheasoft">HEAsoft Home</A>
<BR>
<B> Next:</B> <A NAME="tex2html259"
  HREF="node17.html">HEAdas Makefiles</A>
<B> Up:</B> <A NAME="tex2html255"
  HREF="node12.html">Overview of HEAdas Libraries</A>
<B> Previous:</B> <A NAME="tex2html251"
  HREF="node15.html">heautils</A>
 &nbsp; <B>  <A NAME="tex2html257"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00340000000000000000">
heasp</A>
</H1>

<P>

<UL>
<LI><PRE> MergeARFRMF.c
</PRE>
            Contains routine to multiply an ARF and an RMF.

<P>

<UL>
<LI><TT>long MergeARFRMF(struct ARF *arf, struct RMF *rmf) </TT>

<P>
Multiplies the ARF and RMF structures and returns
                  the result in the RMF structure. If there is a
                  mismatch between energy bins returns the first
                  inconsistent bin number.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> RMF.c
</PRE>
            Contains RMF manipulation routines.

<P>

<UL>
<LI><TT>void RMFCompressLine(float
                     *Vector, long VectorLength, float Threshold, long
                     CurrentGroup, long CurrentElement, 
                     long *GroupStart, long *GroupSize, long *GroupFirstElement,
                     long *NumberGroups, float *MatrixElements, 
                     long *NumberElements) </TT>

<P>
Compress the vector representation of the response
                  for a single energy and add into the RMF.

<P>
</LI>
<LI><TT>void RMFExpandLine(long
  	             *GroupStart, long *GroupSize, long *GroupFirstElement, 
                     long NumberGroups, long FirstGroup, float *MatrixElements, 
                     long VectorLength, float *Vector) </TT>

<P>
Extract from the RMF the vector representation of
		  the response for a single energy.

<P>
</LI>
<LI><TT>float ReturnRMFElement(struct RMF *rmf, long channel, long energybin)</TT>

<P>
Return the RMF element for the input channel and
                  energy bin.

<P>
</LI>
<LI><TT>float ReturnRMFchanElement(struct RMFchan *rmfchan, long channel, long energybin)</TT>

<P>
Return the RMF element for the input channel and
                  energy bin when the RMF is stored in the transposed
                  RMFchan structure.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> ReadARF.c
</PRE>
            Contains routine to read an ARF.

<P>

<UL>
<LI><TT>int ReadARF(fitsfile *fptr, long ARFnumber, struct ARF *arf)</TT>

<P>
Read an ARF from the SPECRESP extension in the
                  opened FITS file. If there are multiple SPECRESP
                  extensions will read the ARFnumber one.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> ReadPHA.c
</PRE>
            Contains routine to read a PHA file.

<P>

<UL>
<LI><TT>int ReturnPHAtype(fitsfile *fptr, long PHAnumber)</TT>

<P>
Return either 1 or 2 depending on whether the
                  PHAnumber'th SPECTRUM extension  is a type 1 or 2
                  PHA type.

<P>
</LI>
<LI><TT>long ReturnNumberofSpectra(fitsfile *fptr, long PHAnumber)</TT>

<P>
Return the number of spectra in the PHAnumber'th
                  SPECTRUM extension in the opened file.

<P>
</LI>
<LI><TT>int ReadPHAtypeI(fitsfile *fptr, long PHAnumber, struct PHA *pha)</TT>

<P>
Read the PHAnumber'th SPECTRUM extension into the
                  PHA structure. Assumes the file is opened but not
                  necessarily positioned at the correct extension.

<P>
</LI>
<LI><TT>int ReadPHAtypeII(fitsfile *fptr, long PHAnumber, long NumberSpectra, long *SpectrumNumber, struct PHA **pha)</TT>

<P>
Read the PHAnumber'th SPECTRUM extension. Reads the
                  spectra specified by the SpectrumNumber array into
                  an array of PHA structures.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> ReadRMF.c
</PRE>
            Contains routines to read the RMF file.

<P>

<UL>
<LI><TT>int ReadRMFMatrix(fitsfile *fptr, long RMFnumber, struct RMF *rmf)</TT>

<P>
Read the RMFnumber'th MATRIX (or SPECRESP MATRIX)
                  extension into a RMF structure.

<P>
</LI>
<LI><TT>int ReadRMFEbounds(fitsfile *fptr, long EBDnumber, struct RMF *rmf)</TT>

<P>
Read the EBDnumber'th EBOUNDS extension into a RMF structure.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> ReturnChannel.c
</PRE>
            Routine to return a channel given an RMF and an input energy.

<P>

<UL>
<LI><TT>void ReturnChannel(struct RMF *rmf, float energy, int NumberPhoton, long *channel)</TT>

<P>
Return NumberPhoton channel numbers from the input
                  energy by drawing randum numbers from a distribution
                  derived from the RMF.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> SPio.c
</PRE>
            Internal I/O routines mainly to provide transparent
            handling of keywords which may be columns in type II PHA files.

<P>

<UL>
<LI><TT>int SP_read_key(fitsfile *fptr, int datatype, char *keyword_name, void *keyword_value, void *keyword_default) </TT>

<P>
Read keyword_name of type datatype into
                  keyword_value.

<P>
</LI>
<LI><TT>int SPII_read_key(fitsfile *fptr, int datatype, char *keyword_name, long ispec, void *keyword_value, void *keyword_default)</TT>

<P>
Read keyword_name or type datatype into
                  keyword_value from a type II file. Looks first for a
                  keyword of the requested name then if ispec &gt; 0 for
                  an entry in a column.

<P>
</LI>
<LI><TT>int SP_read_col(fitsfile *fptr, int datatype, char *column_name, long number_values, void *column_values) </TT>

<P>
Read column_name of type datatype into column_values.

<P>
</LI>
<LI><TT>int SPII_read_col(fitsfile *fptr, int datatype, char *column_name, long ispec, long number_values, void *column_values)</TT>

<P>
Read column_name of type datatype into
                  column_values. Will read either from a keyword, a
                  column, or a vector element of a column as
                  appropriate.

<P>
</LI>
<LI><TT>int SP_write_key(fitsfile *fptr, int datatype, char *keyword_name, void *keyword_value, char *comment)</TT>

<P>
Write keyword_value to keyword_name.

<P>
</LI>
<LI><TT>int SPII_write_key(fitsfile *fptr, int tfields, char *ttype[], int datatype, char *keyword_name, void *keyword_value, char *comment)</TT>

<P>
Write keyword_value to keyword_name unless it is a column.

<P>
</LI>
<LI><TT>int SP_need_col(void *array, long array_size, int datatype)</TT>

<P>
Returns true if not all elements of array are the
                  same value.

<P>
</LI>
<LI><TT>int SPII_set_table_str(char *column_name, char **column_values, long number_values, int *tfields, char *ttype[], char *tform[], char *tunit[])</TT>

<P>
Check whether the array of strings in column_values
                  are all the same. If not set the table parameters
                  and increment the tfield counter.

<P>
</LI>
<LI><TT>int SP_write_col(fitsfile *fptr, int datatype, char *column_name, int *colnum, long nrows, void *column_values)</TT>

<P>
Writes column_values to column_name unless all the
                  values are the same in which case write to a
                  keyword. If a column is written the colnum is
                  incremented.

<P>
</LI>
<LI><TT>int SPII_write_col(fitsfile *fptr, int tfields, char *ttype[], int datatype, char *column_name, int rownum, long vector_length, void *column_values)</TT>

<P>
Write column_values as a vector element in
                  column_name.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> SPutils.c
</PRE>
            Internal utility routines for the heasp library.

<P>

<UL>
<LI><TT>int SPReadBinningFile(char *filename, struct BinFactors *binning)</TT>

<P>
Read an ascii file of binning factors into the
                  BinFactors structure.

<P>
</LI>
<LI><TT>int SPSetGroupArray(int inputSize, struct BinFactors *binning, int *grouping)</TT>

<P>
Sets up a grouping array using the information in
                  the BinFactors structure. Assumes that the grouping
                  array has been allocated enough memory, that the
                  binning ranges are contiguous, the start channel of
                  a range is the channel after the end channel of the 
                  previous range, and that the first channel is 1.

<P>
</LI>
<LI><TT>int SPBinArray(int inputSize, float *input, int *grouping, int mode, float *output)</TT>

<P>
Bin the input array up using the grouping data to
                  create the output array. Mode takes four values : 1
                  means sum bins, 2 take the mean, 3 return the value
                  of the first channel in the bin, and 4 return the
                  value of the last channel in the bin.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> TransposeRMF.c
</PRE>
            Routine to transpose the RMF matrix.

<P>

<UL>
<LI><TT>void TransposeRMF(struct RMF *rmf, struct RMFchan *rmfchan)</TT>

<P>
Transpose the matrix in the RMF structure and output
                  in the RMFchan structure.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> WriteARF.c
</PRE>
            Routine to write an ARF.

<P>

<UL>
<LI><TT>int WriteARF(fitsfile *fptr, struct ARF *arf)</TT>

<P>
Write the ARF structure to the output FITS
                  file. Assumes the file is open and creates a new
                  SPECRESP extension.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> WritePHA.c
</PRE>
            Routines to write the PHA file.

<P>

<UL>
<LI><TT>int WritePHAtypeI(fitsfile *fptr, struct PHA *pha)</TT>

<P>
Write the PHA structure to the output FITS
                  file. Assumes the file is open and creates a new
                  SPECTRUM extension.

<P>
</LI>
<LI><TT>int WritePHAtypeII(fitsfile *fptr, long NumberSpectra, struct PHA **pha)</TT>

<P>
Write the array of PHA structures to the output FITS
                  file. Assumes the file is open and creates a new
                  type II SPECTRUM extension.

<P>
</LI>
</UL>

<P>
</LI>
<LI><PRE> WriteRMF.c
</PRE>
            Routines to write the RMF file.

<P>

<UL>
<LI><TT>int WriteRMFMatrix(fitsfile *fptr, struct RMF *rmf)</TT>

<P>
Write the MATRIX extension to the output FITS file. 
                  Assumes the file is open and creates a new
                  extension.

<P>
</LI>
<LI><TT>int WriteRMFEbounds(fitsfile *fptr, struct RMF *rmf)</TT>

<P>
Write the EBOUNDS extension to the output FITS file. 
                  Assumes the file is open and creates a new
                  extension.

<P>
</LI>
</UL>

<P>
</LI>
</UL>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html258"
  HREF="node17.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/sw/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html254"
  HREF="node12.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/sw/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html250"
  HREF="node15.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/sw/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html256"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/sw/share/lib/latex2html/icons/contents.png"></A>  
 <A HREF="http://heasarc.gsfc.nasa.gov/docs/software/lheasoft">HEAsoft Home</A>
<BR>
<B> Next:</B> <A NAME="tex2html259"
  HREF="node17.html">HEAdas Makefiles</A>
<B> Up:</B> <A NAME="tex2html255"
  HREF="node12.html">Overview of HEAdas Libraries</A>
<B> Previous:</B> <A NAME="tex2html251"
  HREF="node15.html">heautils</A>
 &nbsp; <B>  <A NAME="tex2html257"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Keith Arnaud
2008-03-13
</ADDRESS>
</BODY>
</HTML>
