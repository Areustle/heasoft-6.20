This is a unit test of the functions implemented in the "ahfits" library:

void testAhFitsOpenClose(void);
void testAhFitsCreate(void);
void testAhFitsConnect(void);
void testAhFitsRead(void);
void testAhFitsWrite(void);

Please build the unit test via "hmake test" and it may run here:

./testahfits

ls -1 ./input should show:

event_file_1.fits
event_file_2.fits
event_file_3.fits
event_file_list.txt

ls -1 ./output should show:

testahfits.fits


Please feel free to examine the content of the FITS files via the standard HEADAS Ftool "fv".

