<!--=======================================-->
<!--  HEADAS HTML HELP FILE TEMPLATE, v1.1 -->
<!--=======================================-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<style type="text/css">
  body { margin-left: 5%; margin-right: 5%; }
  h1,h2,h3,h4 { margin-left: -5%;}
</style>
<title>batsurvey-detmask HEADAS help file</title>
</head>
<body>

<h2>NAME</h2>

batsurvey-detmask - perform spatial filtering of BAT detector maps

<h2>USAGE</h2>

<tt>batsurvey-detmask infile outfile</tt>

<h2>DESCRIPTION</h2>

<p>
batsurvey-detmask performs spatial filtering of BAT detector plane
maps, for the purpose of BAT survey analysis.

<p>
This task examines a detector plane image file (DPI file), and
performs standard filtering to remove known "bad" detectors.  The
kinds of detectors which are flagged as "bad" are:
<ol>
<li>disabled detectors, as specified in the detector enable/disable map;</li>
<li>known "bad" detectors, as given by the 'batdetmask' task;</li>
<li>name of global pattern mask, as specified by the 'patternmask' parameter;</li>
<li>user-requested quality map, as specified by the 'detmask' parameter;</li>
<li>hot pixels, as found by the 'bathotpix' task.</li>
</ol>


<h2>PARAMETERS</h2>
<dl>

<dt>infile [string]

<dd>The name of input detector plane image file.  Only one file name
is allowed, but the file may contain multiple image extensions
(usually corresponding to different energy bands).
<p>

<dt>outfile [string]

<dd>The file name of the final output quality map.
<p>

<dt>(detflagfile = "NONE") [string]

<dd>Name of detector enable/disable file, or "NONE".  If the input
enable/disable file contains multiple rows, batsurvey-detmask will
determine which map to use based on the time of the observation.
<p>

<dt>(detmask = "NONE") [string]

<dd>Detector quality mask file, or "NONE".  This should be a standard
BAT detector quality map, such as one produced by bathotpix.
<p>

<dt>(patternmask = "NONE") [string]

<dd>Global pattern mask file name, or "NONE".  In general this
parameter is a way to specify an additional quality mask.
<p>

<dt>(totalmap = "YES") [boolean]

<dd>By default, bathotpix is run on each input map individually.  If
totalmap=YES, then bathotpix is also run on the sum of all maps.
<p>

<dt>(outenamask = "INDEF") [string]

<dd>This parameter allows the user to know which enable/disable map
batsurvey-detmask chose.  Set this parameter to a file name where the
chosen map will be saved, or "INDEF" to disable saving.  This parameter
doesn't change the final output file in any way.
<p>

<dt>(outcaldbmask = "INDEF") [string]

<dd>This parameter allows the user to know which global detector
quality map batsurvey-detmask chose from CALDB.  Set this parameter to
a file name where the chosen map will be saved, or "INDEF" to disable
saving.  This parameter doesn't change the final output file in any
way.
<p>

<dt>(cleanup = "YES") [boolean]

<dd>If set, then intermediate files will be deleted.
<p>

<dt>(repoquery = "NO") [boolean]

<dd>BAT internal team usage only.
<p>

<dt>(clobber = YES) [boolean]

<dd>This task will <i>always</i> clobber files, so clobber=NO has no effect.
<p>

<dt>(chatter = 2) [integer, 0 - 5]

<dd>Controls the amount of informative text written to standard
output.  Setting chatter = 1 produces a basic summary of the task
actions; chatter = 2 (default) additionally prints the task results;
chatter = 5 prints debugging information.
<p>

<dt>(history = YES) [boolean]

<dd>Ignored.
<p>

</dl>
<h2>EXAMPLES</h2>

<p>

1. Analyze a DPI file named mydpi.fits, and save the results in
mydpi.detmask.  The observation directory is 00035025015, where the
enable/disable housekeeping file is drawn from.

<p>
<pre>
     batsurvey-detmask infile=mydpi.fits outfile=mydpi.detmask \
          detflagfile=00035025015/bat/hk/sw00035025015bdecb.hk \
          detmask=NONE
</pre>

<h2>SEE ALSO</h2>

<p>
<a href="batsurvey.html">batsurvey</a>, 
<a href="batdetmask.html">batdetmask</a>
</p>

<h2>LAST MODIFIED</h2>

Jun 2008

</body>
</html>
